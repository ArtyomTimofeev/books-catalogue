(this.webpackJsonpcatalogue=this.webpackJsonpcatalogue||[]).push([[0],{302:function(e,a,r){},303:function(e,a,r){"use strict";r.r(a);var t=r(0),n=r.n(t),o=r(55),l=r.n(o),i=r(19),c=r(357),s=r(359),u=r(311),d=r(360),h=r(163),j=r.n(h),b=r(1),m=function(e){var a=e.setOpenForm;return Object(b.jsx)(c.a,{position:"fixed",color:"primary",children:Object(b.jsxs)(s.a,{variant:"dense",children:[Object(b.jsx)(u.a,{sx:{flexGrow:1},variant:"h6",color:"inherit",component:"div",children:"Books Catalogue"}),Object(b.jsx)(d.a,{onClick:function(){a(!0)},children:Object(b.jsx)(j.a,{sx:{color:"white"}})})]})})},f=r(6),g=r(370),x=r(356),p=r(21),O=r.n(p),B=r(25),v=r(361),y=r(362),k=r(363),S=r(352),C=r(367),I=r(368),w=n.a.createContext(),U=r(130),N=r(164),z=r(41),T=Object(N.a)({apiKey:"AIzaSyCdIIk8J1UY3OArt4scuMj_6U2ksBsGhAc",authDomain:"bookscatalogueapp.firebaseapp.com",projectId:"bookscatalogueapp",storageBucket:"bookscatalogueapp.appspot.com",messagingSenderId:"478529836031",appId:"1:478529836031:web:67f77910c89fbb944c0dca"}),W=Object(z.f)(T),F=r(165),q={getBooks:function(){return Object(B.a)(O.a.mark((function e(){var a,r,t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(F.a)(Object(z.b)(W,"books")),e.next=3,Object(z.e)(a);case 3:return r=e.sent,t=r.docs.map((function(e){return Object(U.a)(Object(U.a)({},e.data()),{},{id:e.id})})),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))()},createBook:function(e){return Object(B.a)(O.a.mark((function a(){return O.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return""===e.rating&&(e.rating=0),a.next=3,Object(z.a)(Object(z.b)(W,"books"),e);case 3:case"end":return a.stop()}}),a)})))()},updateBook:function(e,a){return Object(B.a)(O.a.mark((function r(){var t,n;return O.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return""===e.rating&&(e.rating=0),t=Object(z.d)(W,"books",a),n={name:e.name,author:e.author,year:e.year,rating:e.rating,ISBN:e.ISBN,imgUrl:e.imgUrl},r.next=5,Object(z.g)(t,n);case 5:case"end":return r.stop()}}),r)})))()},deleteBook:function(e){return Object(B.a)(O.a.mark((function a(){var r;return O.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=Object(z.d)(W,"books",e),a.next=3,Object(z.c)(r);case 3:case"end":return a.stop()}}),a)})))()}},A=r.p+"static/media/book.7fa780f1.png",D=r(33),G=r(111),R=function(e){var a=e.book,r=e.nonEditableBookCard,n=Object(t.useContext)(w).setAllBooks,o=Object(t.useState)(!1),l=Object(i.a)(o,2),c=l[0],s=l[1],d=D.b().shape({name:D.c().required("required field").max(100),author:D.c().required("required field"),year:D.a().min(1800).max((new Date).getFullYear()).integer(),rating:D.a().min(0).max(10).integer(),ISBN:D.c().matches(/^(?=(?:\D*\d){10}(?:(?:\D*\d){3})?$)[\d-]+$/,"ISBN is not valid"),imgUrl:D.c().matches(/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/,"URL is not valid")}),h=Object(G.a)({initialValues:{name:a.name,author:a.author,year:a.year,rating:a.rating,ISBN:a.ISBN,imgUrl:a.imgUrl},validationSchema:d,onSubmit:function(){var e=Object(B.a)(O.a.mark((function e(){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s(!1),!(r=Object.keys(h.initialValues)).some((function(e){return h.initialValues[e]!==h.values[e]}))){e.next=7;break}return e.next=5,q.updateBook(h.values,a.id);case 5:q.getBooks().then((function(e){n(e)})),r.map((function(e){return h.initialValues[e]=h.values[e]}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),j=function(){var e=Object(B.a)(O.a.mark((function e(a){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.deleteBook(a);case 2:q.getBooks().then((function(e){n(e)}));case 3:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return Object(b.jsxs)(v.a,{children:[Object(b.jsx)(y.a,{sx:{objectFit:"contain",pt:1,pb:1},component:"img",height:"140",image:a.imgUrl||A}),Object(b.jsxs)(k.a,{sx:{background:"#fedbff",height:140,padding:1,overflow:"auto"},children:[c?Object(b.jsx)(S.a,{size:"small",autoFocus:!0,margin:"dense",id:"name",name:"name",label:"Book title",type:"text",fullWidth:!0,onChange:h.handleChange,onBlur:h.handleBlur,value:h.values.name,error:h.touched.name&&Boolean(h.errors.name),helperText:h.touched.name&&h.errors.name,required:!0}):Object(b.jsx)(u.a,{gutterBottom:!0,component:"div",children:Object(b.jsx)("b",{children:a.name})}),c?Object(b.jsx)(S.a,{size:"small",margin:"dense",id:"author",name:"author",label:"List of authors",type:"text",fullWidth:!0,onChange:h.handleChange,onBlur:h.handleBlur,value:h.values.author,error:h.touched.author&&Boolean(h.errors.author),helperText:h.touched.author&&h.errors.author,required:!0}):Object(b.jsxs)(u.a,{variant:"body2",color:"text.secondary",children:[Object(b.jsx)("b",{children:"Author: "})," ",a.author||"\u2014"]}),c?Object(b.jsx)(S.a,{size:"small",margin:"dense",id:"year",name:"year",label:"Publication year",type:"number",fullWidth:!0,onChange:h.handleChange,onBlur:h.handleBlur,value:h.values.year,error:Boolean(h.errors.year),helperText:h.errors.year}):Object(b.jsxs)(u.a,{variant:"body2",color:"text.secondary",children:[Object(b.jsx)("b",{children:"Year: "})," ",a.year||"\u2014"]}),c?Object(b.jsx)(S.a,{size:"small",margin:"dense",id:"rating",name:"rating",label:"Rating",type:"number",fullWidth:!0,onChange:h.handleChange,onBlur:h.handleBlur,value:h.values.rating,error:Boolean(h.errors.rating),helperText:h.errors.rating}):Object(b.jsxs)(u.a,{variant:"body2",color:"text.secondary",children:[Object(b.jsx)("b",{children:"Rating: "})," ",a.rating||0]}),c?Object(b.jsx)(S.a,{size:"small",margin:"dense",id:"ISBN",name:"ISBN",label:"ISBN",type:"text",fullWidth:!0,onChange:h.handleChange,onBlur:h.handleBlur,value:h.values.ISBN,error:Boolean(h.errors.ISBN),helperText:h.errors.ISBN}):Object(b.jsxs)(u.a,{variant:"body2",color:"text.secondary",children:[Object(b.jsx)("b",{children:"ISBN: "})," ",a.ISBN||"\u2014"]}),c&&Object(b.jsx)(S.a,{size:"small",margin:"dense",id:"imgUrl",name:"imgUrl",label:"Image URL",type:"text",fullWidth:!0,onChange:h.handleChange,onBlur:h.handleBlur,value:h.values.imgUrl,error:Boolean(h.errors.imgUrl),helperText:h.errors.imgUrl})]}),Object(b.jsxs)(C.a,{disableSpacing:!0,children:[c?Object(b.jsx)(I.a,{onClick:h.handleSubmit,sx:{flexGrow:1},size:"small",color:"secondary",children:"Save"}):Object(b.jsx)(I.a,{onClick:function(){s(!0)},sx:{flexGrow:1},size:"small",color:"secondary",disabled:Boolean(r),children:"Edit"}),Object(b.jsx)(I.a,{onClick:function(){return j(a.id)},sx:{flexGrow:1},size:"small",color:"error",children:"Delete"})]})]})},E=function(e){var a=e.groupOfBooks,r=e.groupingType;return Object(b.jsxs)("div",{children:[Object(b.jsx)(u.a,{gutterBottom:!0,variant:"h4",children:a[0][r]||"Other books"}),Object(b.jsx)(x.a,{container:!0,spacing:2,sx:{mb:6},children:a.map((function(e){return Object(b.jsx)(x.a,{item:!0,xs:12,sm:6,md:4,lg:3,children:Object(b.jsx)(R,{book:e},e.id)},e.id)}))})]})},L=r(110),$=function(e){var a=e.allBooks,r=Object(t.useState)([]),n=Object(i.a)(r,2),o=n[0],l=n[1];return Object(t.useEffect)((function(){var e=(new Date).getFullYear(),r=a.filter((function(a){return a.year<=e-3&&a.rating}));if(r.length>0){var t=Math.max.apply(null,r.map((function(e){return e.rating}))),n=L.a.where(r,{rating:t}),o=n[Math.floor(Math.random()*n.length)];l(o)}}),[a]),Object(b.jsxs)("section",{children:[Object(b.jsx)(u.a,{gutterBottom:!0,variant:"h4",children:"Recommended Book"}),Object(b.jsx)(x.a,{container:!0,columnSpacing:2,sx:{mb:6},children:Object(b.jsx)(x.a,{item:!0,xs:12,sm:6,md:4,lg:3,children:Object(b.jsx)(R,{book:o,nonEditableBookCard:!0})})})]})},M=r(369),V=r(366),Y=r(353),P=r(346),J=r(349),K=function(e){var a=e.groupingType,r=e.setGroupingType;return Object(b.jsx)(M.a,{sx:{float:"right"},children:Object(b.jsxs)(V.a,{sx:{minWidth:240},children:[Object(b.jsx)(Y.a,{id:"simple-select-label",children:"Grouping"}),Object(b.jsxs)(P.a,{labelId:"simple-select-label",id:"simple-select",value:a,label:"Grouping",onChange:function(e){r(e.target.value)},children:[Object(b.jsx)(J.a,{value:"year",children:"By year"}),Object(b.jsx)(J.a,{value:"rating",children:"By rating"}),Object(b.jsx)(J.a,{value:"author",children:"By author"})]})]})})},_=r.p+"static/media/preloader.60e8e661.svg",H=function(){return Object(b.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(b.jsx)("img",{src:_,alt:"Preloader"})})},Q=function(e){var a=e.allBooks,r=Object(t.useState)(a),n=Object(i.a)(r,2),o=n[0],l=n[1],c=Object(t.useState)("year"),s=Object(i.a)(c,2),u=s[0],d=s[1];return Object(t.useEffect)((function(){!function(e){"author"===e?a.sort((function(a,r){return a[e]>r[e]?1:-1})):a.sort((function(a,r){return a[e]<r[e]?1:-1}));for(var r=[],t=null,n=0;n<a.length;n++)if(t!==a[n][e]){var o=L.a.where(a,Object(f.a)({},e,a[n][e]));r.push(o),t=a[n][e]}l(r)}(u)}),[a,u]),Object(b.jsx)("main",{style:{backgroundColor:"rgb(232 232 232)"},children:Object(b.jsxs)(g.a,{maxWidth:"xl",sx:{pt:10,pb:4},children:[Object(b.jsx)(K,{groupingType:u,setGroupingType:d}),Object(b.jsx)($,{allBooks:a}),0===o.length?Object(b.jsx)(H,{}):o.map((function(e,a){return e.sort((function(e,a){return e.name>a.name?1:-1})),Object(b.jsx)(E,{groupingType:u,groupOfBooks:e},a)}))]})})},X=r(371),Z=r(345),ee=r(372),ae=r(373),re=r(374),te=function(e){var a=e.openForm,r=e.setOpenForm,t=e.setAllBooks,n=D.b().shape({name:D.c().required("required field").max(100),author:D.c().required("required field"),year:D.a().min(1800).max((new Date).getFullYear()).integer(),rating:D.a().min(0).max(10).integer(),ISBN:D.c().matches(/^(?=(?:\D*\d){10}(?:(?:\D*\d){3})?$)[\d-]+$/,"ISBN is not valid"),imgUrl:D.c().matches(/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/,"URL is not valid")}),o=Object(G.a)({initialValues:{name:"",author:"",year:"",rating:"",ISBN:"",imgUrl:""},validationSchema:n,onSubmit:function(){var e=Object(B.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.createBook(o.values);case 2:q.getBooks().then((function(e){t(e)})),l();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),l=function(){r(!1),o.resetForm()};return Object(b.jsxs)(X.a,{open:a,onClose:l,children:[Object(b.jsx)(Z.a,{children:"Adding a book to catalogue"}),Object(b.jsxs)(ee.a,{children:[Object(b.jsx)(ae.a,{children:"If you want to add a book, please fill these fields."}),Object(b.jsx)(S.a,{autoFocus:!0,margin:"dense",id:"name",name:"name",label:"Book title",type:"text",fullWidth:!0,onChange:o.handleChange,onBlur:o.handleBlur,value:o.values.name,error:o.touched.name&&Boolean(o.errors.name),helperText:o.touched.name&&o.errors.name,required:!0}),Object(b.jsx)(S.a,{margin:"dense",id:"author",name:"author",label:"List of authors",type:"text",fullWidth:!0,onChange:o.handleChange,onBlur:o.handleBlur,value:o.values.author,error:o.touched.author&&Boolean(o.errors.author),helperText:o.touched.author&&o.errors.author,required:!0}),Object(b.jsx)(S.a,{margin:"dense",id:"year",name:"year",label:"Publication year",type:"number",fullWidth:!0,onChange:o.handleChange,onBlur:o.handleBlur,value:o.values.year,error:Boolean(o.errors.year),helperText:o.errors.year}),Object(b.jsx)(S.a,{margin:"dense",id:"rating",name:"rating",label:"Rating",type:"number",fullWidth:!0,onChange:o.handleChange,onBlur:o.handleBlur,value:o.values.rating,error:Boolean(o.errors.rating),helperText:o.errors.rating}),Object(b.jsx)(S.a,{margin:"dense",id:"ISBN",name:"ISBN",label:"ISBN",type:"text",fullWidth:!0,onChange:o.handleChange,onBlur:o.handleBlur,value:o.values.ISBN,error:Boolean(o.errors.ISBN),helperText:o.errors.ISBN}),Object(b.jsx)(S.a,{margin:"dense",id:"imgUrl",name:"imgUrl",label:"Image URL",type:"text",fullWidth:!0,onChange:o.handleChange,onBlur:o.handleBlur,value:o.values.imgUrl,error:Boolean(o.errors.imgUrl),helperText:o.errors.imgUrl})]}),Object(b.jsxs)(re.a,{children:[Object(b.jsx)(I.a,{onClick:l,children:"Cancel"}),Object(b.jsx)(I.a,{color:"secondary",onClick:o.handleSubmit,children:"Add"})]})]})},ne=function(){var e=Object(t.useState)([]),a=Object(i.a)(e,2),r=a[0],n=a[1],o=Object(t.useState)(!1),l=Object(i.a)(o,2),c=l[0],s=l[1];return Object(t.useEffect)((function(){q.getBooks().then((function(e){return n(e)}))}),[]),Object(b.jsxs)(w.Provider,{value:{setAllBooks:n},children:[Object(b.jsx)(m,{setOpenForm:s}),Object(b.jsx)(Q,{allBooks:r,setAllBooks:n}),Object(b.jsx)(te,{setAllBooks:n,openForm:c,setOpenForm:s})]})},oe=(r(302),r(171)),le=r(351),ie=r(65),ce=Object(oe.a)({palette:{primary:{main:"#24292f"},secondary:{main:ie.a[400]}}});l.a.render(Object(b.jsx)(n.a.StrictMode,{children:Object(b.jsx)(le.a,{theme:ce,children:Object(b.jsx)(ne,{})})}),document.getElementById("root"))}},[[303,1,2]]]);
//# sourceMappingURL=main.7a51cfa7.chunk.js.map